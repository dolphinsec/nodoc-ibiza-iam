components:
  parameters:
    spId:
      name: spId
      in: path
      description: >-
        The object ID of the service principal (enterprise application).
      required: true
      schema:
        $ref: common.yml#/components/schemas/servicePrincipalId
  schemas:
    mdmApplication:
      type: object
      properties:
        objectId:
          $ref: common.yml#/components/schemas/servicePrincipalId
        appId:
          type: string
          example: 0000000a-0000-0000-c000-000000000000
          $ref: common.yml#/components/schemas/applicationId
        appDisplayName:
          type: string
          example: Microsoft Intune
        appCategory:
          type: string
          example: Mdm
        logoUrl:
          type: string
          example: https://main.iam.ad.ext.azure.com/api/Images/Applications/...
        isOnPrem:
          type: boolean
          example: false
        appData:
          type: object
          nullable: true
          example: null
        originalAppData:
          type: object
          nullable: true
          readOnly: true
          properties:
            mamEnrollmentUrl:
              type: string
              nullable: true
              example: null
            mamComplianceUrl:
              type: string
              nullable: true
              example: null
            mamTermsOfUseUrl:
              type: string
              nullable: true
              example: null
            enrollmentUrl:
              type: string
              nullable: true
              example: https://ds22.airwatchportals.com/deviceservices/discovery.aws
            complianceUrl:
              type: string
              nullable: true
              example: null
            termsOfUseUrl:
              type: string
              nullable: true
              example: https://ds22.airwatchportals.com/devicemanagement/enrollment
        mdmAppliesTo:
          type: integer
          nullable: true
          readOnly: true
          example: 0
        mamAppliesTo:
          type: integer
          nullable: true
          readOnly: true
          example: 1
        mdmAppliesToGroups:
          type: array
        mamAppliesToGroups:
          type: array
    ssoState:
      type: object
      properties:
        currentSingleSignOnMode:
          description: The current single sign on mode.
          type: string
          enum: [none, federated]
          example: federated
        signInUrl:
          description: The sign in url for the application.
          type: string
          format: url
          nullable: true
          example: https://appsite.null
    federatedSso:
      type: object
      properties:
        objectId:
          $ref: common.yml#/components/schemas/servicePrincipalId
        identifierUris:
          description: Identifier URIs for the application.
          type: array
          items:
            type: string
            example: 442863ba-3c2f-450d-aa38-10815258eaa1
        certificateNotificationEmail:
          description: Email address for certificate expiry notifcations.
          type: string
          example: noreply@consoto.com
        signOnUrl:
          description: Signon URL for the application
          type: string
          format: url
          example: https://localhost.local
        logoutUrl:
          description: Signout URL for the application
          type: string
          format: url
          example: https://localhost.local
        replyUrls:
          description: Reply URLs for the application.
          type: array
          items:
            type: string
            example: http://localhost/redirect
        relayState:
          type: string
          example:
        idpIdentifier:
          type: string
          example:
        idpReplyUrl:
          type: string
          example:
        defaultClaimIssuancePolicy:
          type: object
          properties:
            version:
              type: integer
              minimum: 1
              example: 1
            defaultTokenType:
              type: string
              example: JWT
            allowPassThruUsers:
              type: string
              example: 'true'
            includeBasicClaimSet:
              type: string
              example: 'true'
            claimsSchema:
              type: array
              items:
                type: object
                properties:
                  jwtClaimType:
                    type: string
                    example: enabled
                  samlClaimType:
                    type: string
                    nullable: true
                    example: null
                  samlNameIdFormat:
                    type: string
                    nullable: true
                    example: null
                  spNameQualifier:
                    type: string
                    nullable: true
                    example: null
                  source:
                    type: string
                    example: user
                  extensionID:
                    type: string
                    nullable: true
                    example: null
                  id:
                    type: string
                    example: accountenabled
                  value:
                    type: string
                    nullable: true
                    example: null
                  transformationId:
                    type: string
                    nullable: true
                    example: null
                  appliesToUserType:
                    type: string
                    nullable: true
                    example: null
                  memberOf:
                    type: array
                    nullable: true
                  samlNameFormat:
                    type: string
                    nullable: true
                    example: null
            claimsTransformations:
              type: array
            groupFilter:
              type: string
              nullable: true
              example: null
            issuerWithApplicationId:
              type: boolean
              example: false
            audienceOverride:
              type: boolean
              nullable: true
              example: null
            crossTenantRestrictions:
              type: boolean
              example: true
            requireCustomSigningKey:
              type: boolean
              example: true
        externalClaimIssuancePolicy:
          type: object
          nullable: true
        claimNameIdentifier:
          type: string
          example: userprincipalname
        claimExtensionNameIdentifier:
          type: string
          nullable: true
          example: null
        claimMethodNameIdentifier:
          type: string
          example: mail
        claimMethodDomainName:
          type: string
          nullable: true
          example: null
        tokenIssuancePolicy:
          type: object
          properties:
            version:
              type: integer
              minimum: 1
              example: 1
            signingAlgorithm:
              type: string
              example: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
            tokenResponseSigningPolicy:
              type: string
              example: TokenOnly
            samlTokenVersion:
              type: string
              example: '2.0'
            emitSamlNameFormat:
              type: boolean
              example: false
        tokenIssuancePolicySource:
          type: string
          example: default
    registeredApplication:
      allOf:
        - $ref: '#/components/schemas/registeredApplicationBase'
        - type: object
          properties:
            appId:
              type: string
              example: 2e6339fd-d0a5-44d0-ba5d-c6525ca4ca7a
            appRoles:
              type: array
            availableToOtherTenants:
              type: boolean
              example: false
            displayName:
              type: string
              example: Portals-Site 1
            errorUrl:
              type: string
              format: url
              nullable: true
              example: null
            groupMembershipClaims:
              type: array
              nullable: true
            optionalClaims:
              type: array
              nullable: true
            acceptMappedClaims:
              type: array
              nullable: true
            homepage:
              type: string
              nullable: true
              example: null
            informationalUrls:
              type: object
              properties:
                privacy:
                  type: string
                  format: url
                  nullable: true
                  example: null
                termsOfService:
                  type: string
                  format: url
                  nullable: true
                  example: null
            identifierUris:
              type: array
            keyCredentials:
              type: array
            knownClientApplications:
              type: array
            logoutUrl:
              type: string
              format: url
              nullable: true
              example: null
            oauth2AllowImplicitFlow:
              type: boolean
              example: false
            oauth2AllowUrlPathMatching:
              type: boolean
              example: false
            oauth2Permissions:
              type: array
              items:
                type: object
                properties:
                  adminConsentDescription:
                    type: string
                    example: Allow the application to access Portals-Site 1 on behalf of the signed-in user.
                  adminConsentDisplayName:
                    type: string
                    example: Access Portals-Site 1
                  id:
                    type: string
                    example: 37e2e359-45d8-46b0-9720-7d4c752af6ff
                  isEnabled:
                    type: boolean
                    example: true
                  type:
                    type: string
                    example: User
                  userConsentDescription:
                    type: string
                    example: Allow the application to access Portals-Site 1 on your behalf.
                  userConsentDisplayName:
                    type: string
                    example: Access Portals-Site 1
                  value:
                    type: string
                    example: user_impersonation
            oauth2RequirePostResponse:
              type: boolean
              example: false
            objectId:
              type: string
              example: 74e000e4-3a97-45b9-acd8-414bab41e0b6
            parentalControlSettings":
              type: object
              properties:
                countriesBlockedForMinors:
                  type: array
                legalAgeGroupRule:
                  type: string
                  example: Allow
            passwordCredentials:
              type: array
            publicClient:
              type: boolean
              example: false
            supportsConvergence:
              type: boolean
              example: false
            replyUrls:
              type: array
            requiredResourceAccess:
              type: array
              items:
                type: object
                properties:
                  resourceAppId:
                    type: string
                    example: 00000002-0000-0000-c000-000000000000
                  resourceAccess:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: 311a71cc-e848-46a1-bdf8-97ff7156d8e6
                        type:
                          type: string
                          example: Scope
                  resourceApp:
                    type: object
                    nullable: true
            samlMetadataUrl:
              type: string
              nullable: true
              example: null

            logoUrl:
              type: string
              example: https://main.iam.ad.ext.azure.com/api/Images/Applications/yytOmm9B92beL3OolH8jyO6M4LAZauiLJwNnU8-2dac=.jpg?t=638508570566299681
            logoChanged:
              type: boolean
              nullable: true
              example: false
            defaultIdentifierUri:
              type: string
              nullable: true
              example: null
            appCategory:
              type: string
              nullable: true
              example: null
    registeredApplicationBase:
      type: object
      properties:
        objectType:
          type: string
          example: Application
        objectId:
          type: string
          example: 6b061bf8-f63b-4567-bcd6-735f35ebce89
          readOnly: true
        appId:
          type: string
          example: 2305d473-3c0b-4853-af61-94a4389d0ad2
          readOnly: true
        displayName:
          type: string
          example: Portals-Site 1
        homepage:
          type: string
          nullable: true
          example: null
        appCategory:
          type: string
          nullable: true
          example: null
        publicClient:
          type: boolean
          example: false
        supportsConvergence:
          type: boolean
          example: false
        logoUrl:
          type: string
          format: url
          example: https://main.iam.ad.ext.azure.com/api/Images/Applications/...
    appRoleAssignment:
      type: object
      properties:
        objectId:
          description: The unique identifier of the app role assignment.
          type: string
          example: hfge0cD7XUuMjGoyQ69KAGblVnm7AndHuUlIkV8dSfk
        id:
          description: The unique identifier of the app role.
          type: string
          example: a39633e3-7be8-4402-ac1c-d9234fa03519
        principalDisplayName:
          description: The display name of the principal that has been assigned the app role.
          type: string
          example: User123
        creationTimeStamp:
          description: The timestamp of app role assignment.
          type: string
          format: date-time
          example: 2024-05-09T12:26:28.6582711Z
        principalId:
          description: The unique identifier of the principal assigned the app role.
          type: string
          format: uuid
          example: d11ef885-fbc0-4b5d-8c8c-6a3243af4a00
        principalType:
          description: The type of principal assigned the role.
          type: string
          example: User
        resourceDisplayName:
          description: The display name of the resource.
          type: string
          example: ApplicationA
        resourceId:
          description: The unique identifier of the resource.
          type: string
          format: uuid
          example: 15e061b9-e3f7-4446-bac8-6a760c00413c
        imageUrl:
          description: URL to the image of the principal assigned the app role.
          type: string
          format: url
          example: https://main.iam.ad.ext.azure.com/Client/Users/Images/defaultUser.svg

    managedApplication:
      type: object
      properties:
        objectId:
          $ref: common.yml#/components/schemas/servicePrincipalId
        appId:
          $ref: common.yml#/components/schemas/applicationId
        displayName:
          description: The display name of the service principal.
          type: string
          example: test
        homePageUrl:
          description: The homepage URL for the application.
          type: string
          example: https://account.activedirectory.windowsazure.com:444/applications/...
        appDisplayName:
          description: The display name of the application.
          type: string
          example: test
        microsoftFirstParty:
          description: Whether the service principal is for a first party microsoft application.
          type: boolean
          nullable: true
          example: null
        logo45Url:
          description: The logo for the application.
          type: string
          example: https://galleryapplogos1.azureedge.net/app-logo/...
        ssoConfiguration:
          description: SSO configuration for the application.
          type: object
          nullable: true
          example: null
        appRoles:
          description: The app roles configured for the application.
          type: array
          items:
            type: object
            properties:
              id:
                description: The unique identifier of the app role.
                type: string
                example: 18d14569-c3bd-439b-9a66-3a2aee01d14f
              isEnabled:
                description: Whether the app role is enabled.
                type: boolean
                example: true
              displayName:
                description: The display name of the application.
                type: string
                example: User
        publisherName:
          description: The publisher name for the application
          type: string
          example: Contoso
        tags:
          description: Tags applied to the application.
          type: array
          items:
            type: string
            enum:
              - WindowsAzureActiveDirectoryCustomSingleSignOnApplication
              - WindowsAzureActiveDirectoryIntegratedApp
        accountEnabled:
          description: Whether the service principal is enabled.
          type: boolean
          example: true
        isSyncInbound:
          description: pending.
          type: boolean
          example: false
        replyUrls:
          description: The reply URLs for the application.
          type: array
          items:
            type: string
            format: url
        publisherDisplayName:
          description: The display name of the application publisher.
          type: string
          nullable: true
          example: null
        appType:
          description: The app type for the service principal.
          type: integer
          example: 5
    userSettings:
      type: object
      properties:
        usersCanAllowAppsToAccessData:
          description: Whether users are permitted to allow apps to access data.
          type: boolean
          nullable: true
          example: null
        usersCanAddGalleryApps:
          description: Whether users can add gallery applications.
          type: boolean
          nullable: true
          example: null
        hideOffice365Apps:
          description: Whether to hide Office 365 applications.
          type: boolean
          nullable: true
          example: null
    enterpriseApplicationProperties:
      type: object
      properties:
        objectId:
          description: The object ID of the service principal (enterprise application).
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          readOnly: true
          example: 9679fc4f-a7b6-40aa-8a45-32e61e30a204
        accountEnabled:
          description: Whether the service principal is enabled.
          type: boolean
          example: true
        displayName:
          description: The display name of the service principal.
          type: string
          example: test
        publisherName:
          description: The publisher name for the application.
          type: string
          readOnly: true
          example: Contoso
        homePageUrl:
          description: The homepage URL for the application.
          type: string
          nullable: true
          readOnly: true
          example: null
        signOnUrl:
          description: The sign-on URL for the application.
          type: string
          nullable: true
          readOnly: true
          example: null
        userAccessUrl:
          description: The user access URL for the application.
          type: string
          readOnly: true
          example: https://launcher.myapps.microsoft.com/api/signin/xx
        appId:
          description: The application ID (client ID) of the application.
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          readOnly: true
          example: 693d2d81-7ad4-41ba-a844-070680da77f9
        appObjectId:
          description: The object ID of the application registration.
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          readOnly: true
          example: 693d2d81-7ad4-41ba-a844-070680da77f9
        appRoleAssignmentRequired:
          description: Whether the application requires assignment to users.
          type: boolean
          example: false
        logoUrl:
          description: The URL of the application logo.
          type: string
          example: https://main.iam.ad.ext.azure.com/api/Images/Applications/xxxx
        applicationPropertiesEditable:
          description: Whether application proerties can be edited.
          type: boolean
          readOnly: true
          example: true
        isApplicationVisible:
          description: Whether the application is visible.
          type: boolean
          readOnly: true
          example: false
        tags:
          description: List of tags applied to the application.
          type: array
          items:
            type: string
            enum: [HideApp, WindowsAzureActiveDirectoryIntegratedApp]
        replyUrl:
          description: The reply URL for the application.
          type: string
          readOnly: true
          example: http://localhost/redirect
        termsOfServiceUrl:
          description: The URL to the application Terms of Service.
          type: string
          readOnly: true
          nullable: true
          example: null
        privacyStatementUrl:
          description: The URL to the application private statement.
          type: string
          nullable: true
          readOnly: true
          example: null
        microsoftFirstParty:
          description: Whether the application is a first party microsoft application.
          type: string
          nullable: true
          readOnly: true
          example: null
        publisherDisplayName:
          description: The display name of the application publisher.
          type: string
          nullable: true
          readOnly: true
          example: null
        appType:
          description: The application type.
          type: integer
          readOnly: true
          example: 3
        notes:
          description: Notes applied to the application.
          type: string
          nullable: true
          example: null
        description:
          description: The service principal description.
          type: string
          nullable: true
          example: null
        servicePrincipalType:
          description: The service principal type.
          type: string
          enum: [Application]
          readOnly: true
          example: Application
        alternativeNames:
          description: Alternative names for the application.
          type: array
          readOnly: true
          items:
            type: string
        disabledByMicrosoftStatus:
          description: Status of application when disabled by Microsoft.
          type: string
          nullable: true
          readOnly: true
          example: null
    managedApplicationList:
      type: object
      properties:
        accountEnabled:
          description: Filter for whether the application is enabled for sign-in.
          type: boolean
          nullable: true
          example: null
        isAppVisible:
          description: Filter for whether the application is visible.
          type: boolean
          nullable: true
          example: null
        appListQuery:
          description: pending.
          type: integer
          example: 0
        top:
          description: The number of applications to return.
          type: integer
          minimum: 1
          maximum: 999
          example: 999
        loadLogo:
          description: Whether to load application logos in the response.
          type: boolean
          example: false
        putCachedLogoUrlOnly:
          description: Whether to load cached application logo URL only in the response.
          type: boolean
          example: false
        nextLink:
          description: The `nextLink` for paging.
          type: string
          nullable: true
          example: ''
        usedFirstPartyAppIds:
          type: array
          nullable: true
          example: null
          items:
            type: string
        __ko_mapping__:
          type: object
          properties:
            ignore:
              type: array
              items:
                type: string
            include:
              type: array
              items:
                type: string
            copy:
              type: array
              items:
                type: string
            observe:
              type: array
              items:
                type: string
            mappedProperties:
              type: object
            copiedProperties:
              type: object
    galleryApplication:
      type: object
      properties:
        id:
          type: string
          example: e9fcfce0-a20b-4d34-b580-909332723090
        displayName:
          type: string
          example: AirWatch by VMware
        homepageUrl:
          type: string
          example: http://www.air-watch.com/
        logo215Url:
          type: string
          example: https://galleryapplogos1.azureedge.net/app-logo/airwatchmdm_3F1A6E2B_215.png
        logo45Url:
          type: string
          example: https://galleryapplogos1.azureedge.net/app-logo/airwatchmdm_3F1A6E2B_45.png
        description:
          type: string
          example: AirWatch by VMware is the leader in enterprise mobility management. The AirWatch platform includes industry-leading mobile device, email, application, content, and browser management solutions. The use of this application is specific to Windows 10.
        publisher:
          type: string
          example: AirWatch
        ssoConfigureInstruction2FwLink:
          type: string
          nullable: true
          example: false
        displayCategories:
          type: array
          items:
            type: string
            example: mdm
        appAlreadyAdded:
          type: boolean
          example: false
        inPreview:
          type: boolean
          example: false
        canBeInstantiated:
          type: boolean
          example: false
        signupUrl:
          type: string
          example: http://www.air-watch.com/
        appKey:
          type: string
          example: airwatchmdm
        appCapabilities:
          type: array
          items:
            type: string
            example: ConditionalAccess
        appCategory:
          type: string
          example: ISV1
        displayCategory:
          type: string
          example: mdm
        ssoOptions:
          type: array
          items:
            type: string
            example: existing

paths:
  /Applications/Gallery:
    get:
      summary: List Gallery Applications
      description: >-
        List Gallery Applications.
      operationId: Application.Gallery.List
      tags: [Service Principal]
      #  parameters:
      #    $ref: common.yml#components/parameters/nextLink
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/galleryApplication'
                  nextLink:
                    $ref: common.yml#/components/schemas/nextLink
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /Applications/Gallery/{appId}:
    parameters:
      - name: appId
        description: pending.
        in: path
        required: true
        schema:
          $ref: common.yml#/components/schemas/applicationId
    get:
      summary: Get Gallery Application by app ID
      description: >-
        Get Gallery Application by application ID (client ID)
      operationId: Application.Gallery.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/galleryApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationManagement/ApplicationObject/{appId}:
    parameters:
      - name: appId
        description: pending.
        in: path
        required: true
        schema:
          $ref: common.yml#/components/schemas/applicationId
    get:
      summary: Get Application Registration by app ID
      description: >-
        Get Application Registration by application ID (client ID)
      operationId: Application.ApplicationObject.Get
      tags: [Application Registration]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  objectId:
                    type: string
                    example: df34926c-fb28-404b-8e1d-7ffdcf209d6b
                  appId:
                    type: string
                    example: bbb4cfab-61a1-48a7-9a7f-a94dcce5f1b4
                  displayName:
                    type: string
                    example: unoauthorized-api-docs
                  homepage:
                    type: string
                    nullable: true
                    example: unoauthorized-api-docs
                  identifierUris:
                    type: array
                    items:
                      type: string
                  publicClient:
                    type: boolean
                    example: false
                  replyUrls:
                    type: array
                    items:
                      type: string
                  logoutUrl:
                    type: string
                    nullable: true
                    example: null
                  keyCredentials:
                    type: array
                  tokenEncryptionKeyId:
                    type: string
                    nullable: true
                    example: null
                  groupMembershipClaims:
                    type: object
                    nullable: true
                  optionalClaims:
                    type: object
                    properties:
                      idToken:
                        type: array
                        items:
                          type: string
                      accessToken:
                        type: array
                        items:
                          type: string
                      saml2Token:
                        type: array
                        items:
                          type: string
                  oauth2AllowIdTokenImplicitFlow:
                    type: boolean
                    example: false
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/UserExtensionProperties:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get Application SSO User Extension Properties
      description: >-
        Get enterprise application single-signon extension properties.
      operationId: Application.UserExtensionProperties.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: array
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/FederatedSsoDefaultClaimsV2:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get Application Federated SSO default claims (V2)
      description: >-
        Get enterprise application federated single-signon default claims (version 2)
      operationId: Application.FederatedSsoDefaultClaimsV2.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  nameIdentifierDefaultClaims:
                    type: object
                  defaultClaims:
                    type: object
                  nameIdentifierUserAttributes:
                    type: object
                    nullable: true
                  defaultUserAttributesAndExtensions:
                    type: object
                    nullable: true
                  singleValueSources:
                    type: array
                    items:
                      type: string
                  enableViewAndEditUserAttribute:
                    type: boolean
                    nullable: true
                    example: null
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/{spId}/SsoApplication:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
    get:
      summary: Get Application SSO properties
      description: >-
        Get enterprise application single-signon properties
      operationId: ApplicationSso.SsoApplication.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  appDisplayName:
                    description: Display name of the application.
                    type: string
                    example: Application 1
                  parentAppId:
                    description: Application ID of a parent application.
                    type: string
                    format: uuid
                    nullable: true
                    example: null
                  isCustomApp:
                    description: Whether application is custom.
                    type: boolean
                    example: false
                  identifierUris:
                    description: A list of identifier URIs.
                    type: array
                    items:
                      type: string
                  replyUrls:
                    description: A list of reply URLs.
                    type: array
                    items:
                      type: string
                      format: url
                  tags:
                    description: Tags applied to the application.
                    type: array
                    items:
                      type: string
                      example: WindowsAzureActiveDirectoryIntegratedApp
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/{spId}/ClaimIssuancePolicyId:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
    get:
      summary: Get Application SSO claim issuance policy ID
      description: >-
        Get enterprise application single-signon claim issuance policy ID
      operationId: ApplicationSso.ClaimIssuancePolicyId.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                nullable: true
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/{spId}/SingleSignOn:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
    get:
      summary: Get Application SSO state
      description: >-
        Get enterprise application single-signon state
      operationId: ApplicationSso.SingleSignOn.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ssoState'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Set Application SSO state
      description: >-
        Set enterprise application single-signon state
      operationId: ApplicationSso.SingleSignOn.Set
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ssoState'
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/{spId}/FederatedSsoClaimsPolicyV2:
    parameters:
      - $ref: '#/components/parameters/spId'
    post:
      summary: Set Application Federated SSO claims policy (V2)
      description: >-
        Set enterprise application federated single-signon claims policy (version 2)
      operationId: ApplicationSso.FederatedSsoClaimsPolicyV2.Set
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/federatedSso'
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ApplicationSso/{spId}/FederatedSsoV2:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
    get:
      summary: Get Application Federated SSO state (v2)
      description: >-
        Get enterprise application federated single-signon state (version 2)
      operationId: ApplicationSso.FederatedSsoV2.Get
      tags: [Service Principal]
      responses:
        '200':
          description: Ok
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/federatedSso'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Set Application Federated SSO state (v2)
      description: >-
        Set enterprise application federated single-signon state (version 2)
      operationId: ApplicationSso.FederatedSsoV2.Set
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/federatedSso'
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /EnterpriseApplications/{spId}/Properties:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
      - in: query
        name: appId
        description: >-
          The application ID of the service principal (enterprise application)
          to retrieve properties for.
        required: true
        schema:
          $ref: common.yml#/components/schemas/applicationId
      - in: query
        name: loadLogo
        description: Whether to load the application logo in the response.
        schema:
          type: boolean
    get:
      summary: Get Enterprise Application properties
      description: >-
        Get Enterprise Application (Service Principal) properties
      operationId: EnterpriseApplication.Properties.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/enterpriseApplicationProperties'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    patch:
      summary: Update Enterprise Application properties
      description: >-
        Update Enterprise Application (Service Principal) properties
      operationId: EnterpriseApplication.Properties.Update
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/enterpriseApplicationProperties'
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /EnterpriseApplications/{spId}/ServicePrincipalPermissions:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
      - name: consentType
        in: query
        description: >-
          Which type of consents to return, `user` or `admin`.
        schema:
          type: string
          enum: [user, admin]
          example: user
      - name: userObjectId
        in: query
        description: >-
          The user for which to retrieve permission grants for.
        schema:
          $ref: common.yml#/components/schemas/userId
    get:
      summary: Get consented Enterprise Application permissions
      description: >-
        Get Enterprise Application (service principal) permissions
        that have been consented within the organisation. Either by
        `admin`, or `user`.
      operationId: EnterpriseApplication.Permissions.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    resourceName:
                      type: string
                      example: Microsoft Graph
                    resourceAppId:
                      type: string
                      example: 5b538740-ddbd-42c6-bc28-15417ca8675f
                    permissionType:
                      type: string
                      example: Delegated
                    permissionDisplayName:
                      type: string
                      example: Sign in and read user profile
                    permissionDescription:
                      type: string
                      example: Allows users to sign-in to the app, and allows the app to read the profile of signed-in users. It also allows the app to read basic company information of signed-in users.
                    permissionId:
                      type: string
                      example: User.Read
                    consentType:
                      type: string
                      example: Admin
                    roleOrScopeClaim:
                      type: string
                      example: User.Read
                    principalIds:
                      type: array
                      items:
                        $ref: common.yml#/components/schemas/userId
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /EnterpriseApplications/UserSettings:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get Enterprise Application user settings
      description: >-
        Get Enterprise Application (service principal) 
        tenant-wide user settings
      operationId: EnterpriseApplication.UserSettings.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/userSettings'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    patch:
      summary: Update Enterprise Application user settings
      description: >-
        Update Enterprise Application (service principal) 
        tenant-wide user settings
      operationId: EnterpriseApplication.UserSettings.Update
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/userSettings'
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ManagedApplications/{spId}:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
    get:
      summary: Get managed application
      description: >-
        Get managed application (service principal) by object ID.
        Note: This operation hangs with no response for invalid service principal ID (`spId`).
      operationId: ManagedApplication.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/managedApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ManagedApplications/List:
    post:
      summary: List managed applications
      description: >-
        List managed applications (service principal).
      operationId: ManagedApplication.List
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/managedApplicationList'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  nextLink:
                    $ref: common.yml#/components/schemas/nextLink
                  appList:
                    type: array
                    items:
                      $ref: '#/components/schemas/managedApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /ManagedApplications/{spId}/AppRoleAssignments:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: '#/components/parameters/spId'
      - $ref: common.yml#/components/parameters/nextLink
      - $ref: common.yml#/components/parameters/top
    get:
      summary: Get managed application app role assignments
      description: >-
        Get managed application (service principal) app role assignments.
        Note: This operation hangs with no response for invalid service principal ID (`spId`).
      operationId: ManagedApplication.AppRoleAssginemnts.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/appRoleAssignment'
                  nextLink:
                    $ref: common.yml#/components/schemas/nextLink
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Create managed application app role assignments
      description: >-
        Create managed application (service principal) app role assignments.
        Note: This operation hangs with no response for invalid service principal ID (`spId`).
      operationId: ManagedApplication.AppRoleAssginemnts.Create
      tags: [Service Principal]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                objectId:
                  $ref: common.yml#/components/schemas/servicePrincipalId
                applicationRoleId:
                  type: string
                  description: The unique identifier of the app role.
                  example: a39633e3-7be8-4402-ac1c-d9234fa03519
                userId:
                  $ref: common.yml#/components/schemas/userId
                groupId:
                  $ref: common.yml#/components/schemas/groupId
                passwordSSOCredentials:
                  description: Password SSO Credentials (format unknown)
                  type: object
                  nullable: true
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/appRoleAssignment'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MdmApplications:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: List MDM applications
      description: >-
        List MDM applications (service principals).
      operationId: MdmApplication.List
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/mdmApplication'

        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MdmApplications/{spId}:
    parameters:
      - in: path
        name: spId
        description: The object ID of the service principal (enterprise application) for the MDM service.
        required: true
        schema:
          $ref: common.yml#/components/schemas/servicePrincipalId
    put:
      parameters:
        - name: mdmAppliesToChanged
          description: Whether the `mdmAppliesTo` value has been updated.
          in: query
          required: true
          schema:
            type: boolean
        - name: mamAppliesToChanged
          description: Whether the `mamAppliesTo` value has been updated.
          in: query
          required: true
          schema:
            type: boolean
      summary: Update MDM application
      description: >-
        Update MDM application (service principals) by object ID.
      operationId: MdmApplication.Update
      tags: [Service Principal]
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException
    get:
      summary: Get MDM application
      description: >-
        Get MDM application (service principals) by object ID.
      operationId: MdmApplication.Get
      tags: [Service Principal]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/mdmApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /RegisteredApplications:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - $ref: common.yml#/components/parameters/nextLink
    get:
      summary: List app registrations
      description: >-
        List application registrations.
      operationId: RegisteredApplication.List
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/registeredApplicationBase'
                  nextLink:
                    $ref: common.yml#/components/schemas/nextLink
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Create app registration
      description: >-
        Create application registration.
      operationId: RegisteredApplication.Create
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/registeredApplication'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/registeredApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /RegisteredApplications/{appId}:
    parameters:
      - in: path
        name: appId
        description: The application ID (client ID) of the application registration to manage.
        required: true
        schema:
          $ref: common.yml#/components/schemas/applicationId
    put:
      summary: Update app registration
      description: >-
        Create application registration.
      operationId: RegisteredApplication.Update
      tags: [Application Registration]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/registeredApplication'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/registeredApplication'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    delete:
      summary: Delete app registration
      description: >-
        Delete application registration by object ID.
      operationId: RegisteredApplication.Delete
      tags: [Application Registration]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: boolean
                example: true
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /RegisteredApplications/{appId}/Consent:
    parameters:
      - in: path
        name: appId
        description: The application ID (client ID) of the application registration to consent.
        required: true
        schema:
          $ref: common.yml#/components/schemas/applicationId
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    post:
      summary: Consent to app registration
      description: >-
        Consent to application registration permissions,
        either for the current user, or on behalf of the organisation (admin consent)
      operationId: RegisteredApplication.Consent
      tags: [Application Registration]
      parameters:
        - name: onBehalfOfAll
          description: Whether to consent on behalf of the organisation (admin consent)
          in: query
          schema:
            type: boolean
      responses:
        '204':
          description: No Content
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException
