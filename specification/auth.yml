components:
  schemas:
    TenantModel:
      type: object
      properties:
        tenantId:
          $ref: common.yml#/components/schemas/tenantId
        licenseKey:
          description: License key for the customer.
          type: string
          example: ABCD1ABC12AB
        customerId:
          description: Identifier for the customer.
          type: integer
          example: 9911991
        accountLockoutDurationMinutes:
          description: Minutes until account is automatically unblocked.
          type: integer
          nullable: true
          minimum: 0
          example: null
        accountLockoutResetMinutes:
          description: Minutes until account lockout counter is reset.
          type: integer
          minimum: 0
          nullable: true
          example: 20
        accountLockoutThreshold:
          description: Number of multifactor authentication denials to trigger account lockout.
          type: integer
          nullable: true
          example: null
        allowPhoneMenu:
          description: Whether to allow phone menu.
          type: boolean
          example: false
        blockForFraud:
          description: Automatically block users who report fraud.
          type: boolean
          example: true
        callerId:
          description: Multifactor authentication caller ID number (US phone number only).
          type: string
          nullable: true
          example: null
        defaultBypassTimespan:
          type: number
          format: float
          example: 300.0
        enableFraudAlert:
          description: Allow users to submit fraud alerts.
          type: boolean
          example: true
        fraudCode:
          type: string
          nullable: true
          example: null
        fraudNotificationEmailAddresses:
          type: array
          nullable: true
          items:
            type: string
        oneTimeBypassEmailAddresses:
          type: array
          nullable: true
          items:
            type: string
        pinAttempts:
          description: Number of PIN attempts allowed per call.
          type: integer
          nullable: true
          example: null
        sayExtensionDigits:
          description: Operator required to transfer extensions.
          type: boolean
          example: false
        smsTimeoutSeconds:
          description: Timeout of SMS MFA timeout (seconds).
          type: integer
          nullable: true
          example: null
        caches:
          type: array
          nullable: true
          items:
            type: object
        notifications:
          type: object
          nullable: true
        notificationEmailAddresses:
          description: MFA notification recipient email addresses.
          type: array
          nullable: true
          items:
            type: string
        greetings:
          description: User greeting objects.
          type: array
          nullable: true
          items:
            type: object
        blockedUsers:
          description: Blocked users.
          type: array
          nullable: true
          items:
            type: string
        bypassedUsers:
          description: Bypassed users.
          type: array
          nullable: true
          items:
            type: string
        groups:
          type: array
          nullable: true
          uniqueItems: true
          items:
            type: object
            properties:
              id:
                type: number
                example: 9880468
              groupName:
                type: string
                example: Azure Default
              etag:
                description: Entity tag for the group.
                type: string
                nullable: true
                example: null
        etag:
          description: Entity tag for the resource.
          type: string
          nullable: true
          example: 1713791283.533179_d80bab12
    OnPremisesPasswordResetPolicy:
      type: object
      properties:
        objectId:
          description: The object ID of the on-premises password reset policy.
          type: string
          nullable: true
          example: null
        passwordWritebackSupported:
          description: Whether password writeback is supported.
          type: boolean
          example: false
        accountUnlockSupported:
          description: Whether account unlock is supported.
          type: boolean
          example: false
        accountUnlockEnabled:
          description: Whether account unlock is enabled.
          type: boolean
          example: false
        enablementForTenant:
          description: Enablement status for tenant.
          type: boolean
          example: false
        cloudProvisioningEnablementForTenant:
          description: Whether cloud provisioning is enabled for the tenant.
          type: boolean
          example: false
    PasswordResetPolicy:
      type: object
      properties:
        objectId:
          description: The object ID of the password reset policy.
          type: string
          example: default
        enablementType:
          description: The policy enablement type.
          type: integer
          example: 0
        numberOfAuthenticationMethodsRequired:
          description: The number of authentication methods required.
          type: integer
          example: 1
        emailOptionEnabled:
          description: Whether email option is enabled.
          type: boolean
          example: true
        mobilePhoneOptionEnabled:
          description: Whether mobile phone option is enabled.
          type: boolean
          example: true
        officePhoneOptionEnabled:
          description: Whether office phone option is enabled.
          type: boolean
          example: true
        securityQuestionsOptionEnabled:
          description: Whether security questions option is enabled.
          type: boolean
          example: true
        mobileAppNotificationEnabled:
          description: Whether mobile app notification option is enabled.
          type: boolean
          example: true
        mobileAppCodeEnabled:
          description: Whether TOTP code option is enabled.
          type: boolean
          example: true
        numberOfQuestionsToRegister:
          description: The number of questions required to register.
          type: integer
          example: 5
        numberOfQuestionsToReset:
          description: The number of questions required to reset.
          type: integer
          example: 3
        registrationRequiredOnSignIn:
          description: Whether to require users to register when signing in.
          type: boolean
          example: true
        registrationReconfirmIntevalInDays:
          description: Number of days before users are asked to re-confirm their authentication information.
          type: integer
          example: 180
        skipRegistrationAllowed:
          description: Whether users are permitted to skip registration.
          type: boolean
          example: true
        skipRegistrationMaxAllowedDays:
          description: The maximum number of days that a user is permitted to skip registration for.
          type: integer
          minimum: 1
          example: 180
        customizeHelpdeskLink:
          description: Whether the helpdesk link is customized.
          type: boolean
          example: false
        customHelpdeskEmailOrUrl:
          description: Custom helpdesk email address or URL.
          type: string
          example: ''
        notifyUsersOnPasswordReset:
          description: Whether to notify users on password reset.
          type: boolean
          example: true
        notifyOnAdminPasswordReset:
          description: Whether to notify administrators on user password reset.
          type: boolean
          example: false
        passwordResetEnabledGroupIds:
          description: Groups enabled for password reset.
          type: array
          items:
            $ref: common.yml#/components/schemas/groupId
        passwordResetEnabledGroupName:
          description: Display names of groups enabled for password reset.
          type: string
          example: ''
        securityQuestions:
          type: array
          uniqueItems: true
          items:
            type: object
            properties:
              objectId:
                description: Unique identifier for the security question.
                type: string
                format: uuid
                example: 8df9f139ad3b44258ef05e5cdf2bd740
              questionText:
                description: The text for the question.
                type: string
                example: In what city was your first job?
              isCustomQuestion:
                description: Whether security question is custom.
                type: boolean
                example: false
        registrationConditionalAccessPolicies:
          type: array
          items:
            type: string
        emailOptionAllowed:
          description: Whether email option is allowed.
          type: boolean
          example: true
        mobilePhoneOptionAllowed:
          description: Whether mobile phone option is allowed.
          type: boolean
          example: true
        officePhoneOptionAllowed:
          description: Whether office phone option is allowed.
          type: boolean
          example: true
        securityQuestionsOptionAllowed:
          description: Whether security questions option is allowed.
          type: boolean
          example: true
        mobileAppNotificationOptionAllowed:
          description: Whether mobile app notification option is allowed.
          type: boolean
          example: true
        mobileAppCodeOptionAllowed:
          description: Whether TOTP code option is allowed.
          type: boolean
          example: true

    PasswordPolicy:
      type: object
      properties:
        lockoutThreshold:
          description: How many failed sign-ins are permitted before a user account is locked out.
          type: integer
          minimum: 1
          maximum: 50
          example: 10
        lockoutDurationInSeconds:
          description: The minimum length in seconds of accounts lockout.
          type: integer
          minimum: 5
          maximum: 18000
          example: 50
        enforceCustomBannedPasswords:
          description: Whether custom banned passwords are enforced.
          type: boolean
          example: true
        customBannedPasswords:
          type: array
          uniqueItems: true
          items:
            description: Banned password
            type: string
            example: Contoso
        enableBannedPasswordCheckOnPremises:
          description: Whether to enforce the banned password check on-premises.
          type: boolean
          example: true
        bannedPasswordCheckOnPremisesMode:
          description: >
            The on-premises banned password mode:
              - `0`: Audit
              - `1`: Enforced
          type: integer
          enum: [0, 1]
          example: 0

    AuthenticationMethod:
      type: object
      properties:
        id:
          $ref: common.yml#/components/schemas/objectId
        type:
          description: >
            Authentication method type:
              - `5`: SMS
              - `6`: FIDO2 Security Key
              - `8`: Microsoft Authenticator
              - `9`: Temporary Access Pass
          type: integer
          enum: [5, 6, 8, 9]
          example: 5
        state:
          type: integer
          description: >
            State of the method:
              - `0`: Enabled
              - `1`: Disabled
          enum: [0, 1]
          example: 0
        includeConditions:
          type: array
          items:
            type: object
            properties:
              type:
                description: Type of include condition.
                type: string
                enum: [group]
                example: group
              id:
                description: ID of group, or `all_users` for all users.
                type: string
                example: all_users
              isRequired:
                description: Whether the method is required.
                type: boolean
                example: false
              useForSignIn:
                description: Whether the method can be used for signin.
                type: boolean
                example: false
        voiceSettings:
          type: object
          nullable: true
        fidoSettings:
          type: object
          nullable: true
          properties:
            allowSelfServiceSetup:
              description: Whether to allow self service setup.
              type: boolean
              example: true
            enforceAttestation:
              description: Whether to enforce attestation.
              type: boolean
              example: false
            keyRestrictions:
              type: object
              properties:
                isEnforced:
                  description: Whether to enforce key restrictions.
                  type: boolean
                  example: false
                enforcementType:
                  description: The enforcement type.
                  type: string
                  enum: [Block, Allow]
                  example: block
                aaGuids:
                  type: array
                  items:
                    description: Authenticator Attestation GUID.
                    type: string
                    format: uuid
        accessPassSettings:
          type: object
          nullable: true
          properties:
            passLifetimeInMinutes:
              description: >
                Temporary access pass lifetime (minutes).
                Must be between `minimumLifetimeInMinutes` and `maximumLifetimeInMinutes`.
              type: integer
              minimum: 10
              example: 60
            length:
              description: The length of generated pass string.
              type: integer
              minimum: 8
              maximum: 48
              example: 8
            minimumLifetimeInMinutes:
              description: >
                The minimum lifetime of the pass (minutes).
                Must be lower than `maximumLifetimeInMinutes`.
              type: integer
              minimum: 10
              example: 60
            maximumLifetimeInMinutes:
              description: >
                The maximum lifetime of the pass (minutes).
                Must be higher than `minimumLifetimeInMinutes`.
              type: integer
              maximum: 43200
              example: 480
            isUsableOnce:
              description: Whether the access pass is only usable once.
              type: boolean
              example: false
            notificationEmail:
              description: Notification email for access pass creation.
              type: string
              nullable: true
              example: null

paths:
  /AuthenticationMethods/AuthenticationMethodsPolicy:
    get:
      summary: Get authentication methods policy
      description: >-
        Get authentication methods policy.
      operationId: AuthenticationMethods.AuthenticationMethodsPolicy.Get
      tags: [Authentication]
      parameters:
        - $ref: common.yml#/components/parameters/XMsClientRequestId
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  authenticationMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuthenticationMethod'
                  policyObjectId:
                    $ref: common.yml#/components/schemas/objectId
                  lastModifiedTime:
                    description: The last modification timestamp of the policy.
                    type: string
                    format: date-time
                    example: 2024-04-22T12:46:50.9622833Z
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Update authentication methods policy
      description: >-
        Update authentication methods policy.
      operationId: AuthenticationMethods.AuthenticationMethodsPolicy.Update
      tags: [Authentication]
      parameters:
        - $ref: common.yml#/components/parameters/XMsClientRequestId
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                authenticationMethods:
                  type: array
                  items:
                    $ref: '#/components/schemas/AuthenticationMethod'
                policyObjectId:
                  $ref: common.yml#/components/schemas/objectId
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  authenticationMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuthenticationMethod'
                  policyObjectId:
                    $ref: common.yml#/components/schemas/objectId
        4XX:
          $ref: common.yml#/components/responses/ClientException
    delete:
      summary: Delete authentication methods policy
      description: >-
        Delete authentication methods policy.
      operationId: AuthenticationMethods.AuthenticationMethodsPolicy.Delete
      tags: [Authentication]
      parameters:
        - $ref: common.yml#/components/parameters/XMsClientRequestId
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                authenticationMethods:
                  type: array
                  items:
                    $ref: '#/components/schemas/AuthenticationMethod'
                policyObjectId:
                  $ref: common.yml#/components/schemas/objectId
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  authenticationMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuthenticationMethod'
                  policyObjectId:
                    $ref: common.yml#/components/schemas/objectId
                  lastModifiedTime:
                    description: The last modification timestamp of the policy.
                    type: string
                    format: date-time
                    example: 2024-04-22T12:46:50.9622833Z
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /AuthenticationMethods/PasswordPolicy:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get password policy
      description: >-
        Get Tenant password policy.
      operationId: AuthenticationMethods.PasswordPolicy.Get
      parameters:
        - $ref: common.yml#/components/parameters/XMsClientRequestId
      tags: [Authentication]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordPolicy'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    post:
      summary: Update password policy
      description: >-
        Update Tenant password policy.
      operationId: AuthenticationMethods.PasswordPolicy.Update
      tags: [Authentication]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordPolicy'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: boolean
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/GetOrCreateExpandedTenantModel:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get expanded MFA tenant model.
      description: >-
        Get expanded multi-factor authentication tenant model.
      operationId: MultiFactorAuthentication.Get
      tags: [Authentication]
      parameters:
        - name: tenantName
          description: The name of the tenant.
          in: query
          schema:
            type: string
            example: contoso
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/TenantModel'
                  - type: object
                    properties:
                      etag:
                        description: Entity tag for the resource.
                        type: string
                        nullable: true
                        example: 1713791283.533179_d80bab12
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/HasPaidSubscription:
    parameters:
      - name: ignoreEnforcementDate
        description: Whether to ignore enforcement date.
        in: query
        schema:
          type: boolean
          example: true
      - name: trialRestrictionKey
        description: pending
        in: query
        schema:
          type: string
    get:
      summary: Check if tenant has paid MFA subscription.
      description: >-
        Check if tenant has paid MFA subscription.
      operationId: MultiFactorAuthentication.PaidSubscription.Check
      tags: [Authentication]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: boolean
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/HardwareToken/enable:
    post:
      summary: Enable hardware MFA tokens
      description: >-
        Enable hardware MFA tokens.
      operationId: MultiFactorAuthentication.HardwareToken.Enable
      tags: [Authentication]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                '@enableAction':
                  type: string
                  enum: [Activate]
                  example: Activate
                oathId:
                  $ref: common.yml#/components/schemas/objectId
                objectId:
                  $ref: common.yml#/components/schemas/objectId
                verificationCode:
                  type: string
                  example: abc123abc123
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/HardwareToken/listUploads:
    get:
      summary: List uploads for hardware MFA tokens
      description: >-
        List uploads for hardware MFA tokens.
      operationId: MultiFactorAuthentication.HardwareToken.Uploads.List
      tags: [Authentication]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/HardwareToken/users:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: List user hardware MFA tokens
      description: >-
        List user hardware MFA tokens.
      operationId: MultiFactorAuthentication.HardwareToken.Users.List
      tags: [Authentication]
      parameters:
        - name: skipToken
          description: Skip token.
          in: query
          schema:
            type: string
        - name: upn
          description: User Principal Name to filter results to.
          in: query
          schema:
            $ref: common.yml#/components/schemas/userPrincipalName
        - name: enabledFilter
          description: Whether results should be filtered to enabled results only.
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: object
                properties:
                  skipToken:
                    description: Skip token.
                    type: string
                    nullable: true
                    example: null
                  items:
                    type: array
                    items:
                      type: object
                      description: Object schema unknown.
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /MultiFactorAuthentication/TenantModel:
    get:
      summary: Get MFA tenant model.
      description: >-
        Get multi-factor authentication tenant model.
      operationId: MultiFactorAuthentication.TenantModel.Get
      tags: [Authentication]
      parameters:
        - name: licenseKey
          description: pending
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/TenantModel'
                  - type: object
                    properties:
                      etag:
                        description: Entity tag for the resource.
                        type: string
                        nullable: true
                        example: 1713791283.533179_d80bab12
        4XX:
          $ref: common.yml#/components/responses/ClientException
    patch:
      summary: Update MFA tenant model.
      description: >-
        Update multi-factor authentication tenant model.
      operationId: MultiFactorAuthentication.TenantModel.Update
      tags: [Authentication]
      parameters:
        - name: licenseKey
          description: pending
          in: query
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantModel'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: string
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /PasswordReset/OnPremisesPasswordResetPolicies:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get on-premises password reset policies
      description: >-
        Get on-premises password reset policies.
      operationId: PasswordReset.OnPremisesPasswordResetPolicies.Get
      tags: [Authentication]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OnPremisesPasswordResetPolicy'
        4XX:
          $ref: common.yml#/components/responses/ClientException
  #  put:
  #    tags: [Authentication]
  #    responses:
  #      # need to update
  #      '200':
  #        description: OK

  /PasswordReset/PasswordResetPolicies:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
    get:
      summary: Get password reset policies.
      description: >-
        Get password reset policies.
      operationId: PasswordReset.PasswordResetPolicies.Get
      tags: [Authentication]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetPolicy'
        4XX:
          $ref: common.yml#/components/responses/ClientException
    put:
      summary: Update password reset policies.
      description: >-
        Update password reset policies.
      operationId: PasswordReset.PasswordResetPolicies.Update
      tags: [Authentication]
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetPolicy'
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: boolean
        4XX:
          $ref: common.yml#/components/responses/ClientException

  /PasswordReset/ResetPasswordByUpn:
    parameters:
      - $ref: common.yml#/components/parameters/XMsClientRequestId
      - name: UserPrincipalName
        description: The user principal name to reset the password for.
        in: query
        schema:
          $ref: common.yml#/components/schemas/userPrincipalName
    put:
      summary: Reset user password by UPN.
      description: >-
        Reset user password by user principal name (UPN).
      operationId: PasswordReset.Execute
      tags: [Authentication]
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: string
        4XX:
          $ref: common.yml#/components/responses/ClientException
