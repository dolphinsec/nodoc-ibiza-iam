components:
  schemas:
    passwordProfile:
      type: object
      properties:
        forceChangePasswordNextLogin:
          type: boolean
        password:
          type: string
    ## TODO: what is roles entity
    rolesEntity:
      type:
      - object
      - 'null'
      properties:
        adminType:
          type: string
        enabledRoles:
          type: string

    CreatedUser:
      type: object
      properties:
        accountEnabled:
          type: boolean
        usageLocation:
          type:
          - string
          - 'null'
        mailNickname:
          type:
          - string
          - 'null'
        passwordProfile:
          $ref: '#/components/schemas/passwordProfile'
        passwordPolicies:
          type:
          - object
          - 'null'
        rolesEntity:
          $ref: '#/components/schemas/rolesEntity'
        selectedRoleIds:
          type: array
          items:
            type: string
        selectedGroupIds:
          type: array
          items:
            type: string
        streetAddress:
          type:
          - string
          - 'null'
        city:
          type:
          - string
          - 'null'
        state:
          type:
          - string
          - 'null'
        country:
          type:
          - string
          - 'null'
        telephoneNumber:
          type:
          - string
          - 'null'
        mobile:
          type:
          - string
          - 'null'
        physicalDeliveryOfficeName:
          type:
          - string
          - 'null'
        postalCode:
          type:
          - string
          - 'null'
        authenticationPhoneNumber:
          type:
          - string
          - 'null'
        authenticationAlternativePhoneNumber:
          type:
          - string
          - 'null'
        authenticationEmail:
          type:
          - string
          - 'null'
        strongAuthenticationDetail:
          type: object
        defaultImageUrl:
          type:
          - string
          - 'null'
          format: uri
        ageGroup:
          type:
          - string
          - 'null'
        consentProvidedForMinor:
          type:
          - boolean
          - 'null'
        legalAgeGroupClassification:
          type:
          - string
          - 'null'
        objectId:
          $ref: common.yml#/components/schemas/userId
        objectType:
          type: string
        displayName:
          type: string
        userPrincipalName:
          $ref: common.yml#/components/schemas/userPrincipalName
        thumbnailPhoto@odata.mediaContentType:
          type:
          - string
          - 'null'
        givenName:
          type:
          - string
          - 'null'
        surname:
          type:
          - string
          - 'null'
        mail:
          type:
          - string
          - 'null'
        dirSyncEnabled:
          type:
          - boolean
          - 'null'
        alternativeSecurityIds:
          type: array
          items:
            type: string
        signInNamesInfo:
          type: array
          items:
            type: object
        signInNames:
          type: array
          items:
            type: string
        ownedDevices:
          type:
          - array
          - 'null'
          items:
            type: object
        jobTitle:
          type:
          - string
          - 'null'
        department:
          type:
          - string
          - 'null'
        displayUserPrincipalName:
          type:
          - string
          - 'null'
        hasThumbnail:
          type:
          - boolean
          - 'null'
        imageUrl:
          type:
          - string
          - 'null'
          format: uri
        imageDataToUpload:
          type:
          - object
          - 'null'
        source:
          type:
          - integer
          - 'null'
        sources:
          type: array
          items:
            type: string
        sourceText:
          type: string
        userFlags:
          type:
          - integer
          - 'null'
        deletionTimestamp:
          type:
          - string
          - 'null'
          format: date-time
        permanentDeletionTime:
          type:
          - string
          - 'null'
          format: date-time
        alternateEmailAddress:
          type:
          - string
          - 'null'
        manager:
          type:
          - string
          - 'null'
        userType:
          type: string
        isThumbnailUpdated:
          type:
          - boolean
          - 'null'
        isAuthenticationContactInfoUpdated:
          type:
          - boolean
          - 'null'
        searchableDeviceKey:
          type: array
          items:
            type: object
        displayEmail:
          type:
          - string
          - 'null'
        creationType:
          type:
          - string
          - 'null'
        userState:
          type:
          - string
          - 'null'
        otherMails:
          type: array
          items:
            type: string
        invitedAsMail:
          type:
          - boolean
          - 'null'
        proxyAddresses:
          type: array
          items:
            type: string
        companyName:
          type:
          - string
          - 'null'
        employeeId:
          type:
          - string
          - 'null'

    User:
      type: object
      properties:
        objectId:
          $ref: common.yml#/components/schemas/userId
        objectType:
          type: string
          enum: [User]
        displayName:
          type: string
        userPrincipalName:
          $ref: common.yml#/components/schemas/userPrincipalName
        thumbnailPhoto@odata.mediaContentType:
          type:
          - string
          - 'null'
        givenName:
          type:
          - string
          - 'null'
        surname:
          type:
          - string
          - 'null'
        mail:
          type: string
        dirSyncEnabled:
          type:
          - string
          - 'null'
        alternativeSecurityIds:
          type: array
          items:
            type: string
        signInNamesInfo:
          type: array
          items:
            type: string
        signInNames:
          type: array
          items:
            type: string
        ownedDevices:
          type:
          - array
          - 'null'
          items:
            type: object
        jobTitle:
          type:
          - string
          - 'null'
        department:
          type:
          - string
          - 'null'
        displayUserPrincipalName:
          type: string
        hasThumbnail:
          type: boolean
        imageUrl:
          type: string
          format: uri
        imageDataToUpload:
          type:
          - string
          - 'null'
        source:
          type: integer
        sources:
          type: array
          items:
            type: string
        sourceText:
          type: string
        userFlags:
          type: integer
        deletionTimestamp:
          type:
          - string
          - 'null'
        permanentDeletionTime:
          type:
          - string
          - 'null'
        alternateEmailAddress:
          type:
          - string
          - 'null'
        manager:
          type:
          - string
          - 'null'
        userType:
          format: string
          enum: [Member]
        isThumbnailUpdated:
          type:
          - boolean
          - 'null'
        isAuthenticationContactInfoUpdated:
          type:
          - boolean
          - 'null'
        searchableDeviceKey:
          type: array
          items:
            type: string
        displayEmail:
          type:
          - string
          - 'null'
        creationType:
          type:
          - string
          - 'null'
        userState:
          type:
          - string
          - 'null'
        otherMails:
          type: array
          items:
            type: string
        invitedAsMail:
          type:
          - boolean
          - 'null'
        proxyAddresses:
          type: array
          items:
            type: string
        companyName:
          type:
          - string
          - 'null'
        employeeId:
          type:
          - string
          - 'null'
    userDetails:
      type: object
      properties:
        givenName:
          type: string
        surname:
          type: string
        jobTitle:
          type: string
        department:
          type: string
        selectedGroupIds:
          type: array
          items:
            type: string
        displayName:
          type: string
        userPrincipalName:
          type: string
        passwordProfile:
          $ref: '#/components/schemas/passwordProfile'
        rolesEntity:
          $ref: '#/components/schemas/rolesEntity'
  #    userInvite:
  #      type: object
  #      properties:
  #        userToInvite:
  #          $ref: '#/components/schemas/userDetails'
  #        inviteMessage:
  #          type: string

  requestBodies:
    userDetails:
      description: A JSON object containing user details
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/userDetails'

paths:
  /User/TemporaryPassword:
    get:
      tags: [Users and Groups]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: string

  # Users?searchText=&top=100&nextLink=&orderByThumbnails=false&maxThumbnailCount=999&filterValue=All&state=All&adminUnit=
  /Users:
    parameters:
    - $ref: common.yml#/components/parameters/XMsClientRequestId
    delete:
      tags: [Users and Groups]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: common.yml#/components/schemas/userId
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: common.yml#/components/schemas/userId
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: common.yml#/components/schemas/userId

  #  /Users/Invite:
  #    parameters:
  #      - $ref: common.yml#/components/parameters/XMsClientRequestId
  #    post:
  #      requestBody:
  #        description: A JSON object containing user invite
  #        required: true
  #        content:
  #            application/json:
  #                schema:
  #                    $ref: users.yml#/components/schemas/userInvite
  #      responses:
  #        '200':
  #          description: OK

  /Users/PermanentDelete:
    parameters:
    - $ref: common.yml#/components/parameters/XMsClientRequestId
    delete:
      tags: [Users and Groups]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: common.yml#/components/schemas/userId
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: common.yml#/components/schemas/userId
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: common.yml#/components/schemas/userId


  /Users/{userId}:
    parameters:
    - $ref: common.yml#/components/parameters/XMsClientRequestId
    - in: path
      name: userId
      required: true
      schema:
        $ref: common.yml#/components/schemas/userId
    get:
      tags: [Users and Groups]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
    delete:
      tags: [Users and Groups]
      responses:
        '200':
          description: OK
          headers:
            Cache-Control:
              $ref: common.yml#/components/headers/Cache-Control
            Content-Encoding:
              $ref: common.yml#/components/headers/Content-Encoding
            Vary:
              $ref: common.yml#/components/headers/Vary
            X-Content-Type-Options:
              $ref: common.yml#/components/headers/X-Content-Type-Options
            X-XSS-Protection:
              $ref: common.yml#/components/headers/X-XSS-Protection
            x-ms-version:
              $ref: common.yml#/components/headers/x-ms-version
            Strict-Transport-Security:
              $ref: common.yml#/components/headers/Strict-Transport-Security
            Access-Control-Expose-Headers:
              $ref: common.yml#/components/headers/Access-Control-Expose-Headers
            x-ms-correlation-id:
              $ref: common.yml#/components/headers/x-ms-correlation-id
            x-ms-operation-maturity:
              $ref: common.yml#/components/headers/x-ms-operation-maturity
            x-ms-expected-duration:
              $ref: common.yml#/components/headers/x-ms-expected-duration
            X-UA-Compatible:
              $ref: common.yml#/components/headers/X-UA-Compatible
            Date:
              $ref: common.yml#/components/headers/Date
            Content-Length:
              $ref: common.yml#/components/headers/Content-Length
          content:
            application/json:
              schema:
                type: boolean

  /Users/IsUPNUniqueOrPending/{userPrincipalName}:
    parameters:
    - $ref: common.yml#/components/parameters/XMsClientRequestId
    - in: path
      name: userPrincipalName
      description: The User Principal Name (UPN) to check status of.
      required: true
      schema:
        $ref: common.yml#/components/schemas/userPrincipalName
    get:
      tags: [Users and Groups]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: string
                enum: [Unique, NotUnique]

  /UserDetails:
    parameters:
    - $ref: common.yml#/components/parameters/XMsClientRequestId
    post:
      tags: [Users and Groups]
      requestBody:
        $ref: '#/components/requestBodies/userDetails'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatedUser'
